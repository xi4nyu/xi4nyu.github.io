---
layout: post
title: "Python 系列2: 基础类型"
date: 2020-02-28 14:52:01 +0800
categories: python
---

## 0 类型

Python 基础类型按可变与不可变分类如下:

不可变类型: 整型(int), 浮点型(float), 字符串(str), 字节(bytes), 元组(tuple), 不可变集合(frozenset)。

可变类型: 字节数组(bytearray), 字典(dict), 列表(list), 可变集合(set)。

### int

Python3 整合了 int 和 long 类型，这个导致更多的内存开销，int 类型只受限制于内存大小，数值可以表示很大。
{% highlight python %}

> > > 2 << 100
> > > 2535301200456458802993406410752
> > > 10 / 3 # 值为 float
> > > 3.3333333333333335
> > > 10 // 3 # 值为 int
> > > 3
> > > {% endhighlight %}

### float

float 默认精度是 16-17 位，float 是基于硬件实现的二进制近似值，不太准确，decimal.Decimal 基于十进制实现的，最高提供 28 位有效精度，可以准确表示十进制运算。注意: 在使用 Decimal 处理浮点数时一定使用字符串传入，不然直接使用浮点还是被当作 Python 的 float 类型，值又会不准确。

{% highlight python %}

> > > 0.1 \* 3
> > > 0.30000000000000004
> > > (0.1+0.1+0.1-0.3) == 0
> > > False
> > > from decimal import Decimal
> > > (Decimal("0.1") + Decimal("0.1") + Decimal("0.1") - Decimal("0.3")) == 0
> > > True
> > > (Decimal(0.1) + Decimal(0.1) + Decimal(0.1) - Decimal(0.3)) == 0
> > > False

{% endhighlight python %}

### str

字符串存储的 Unicode 的不可变文本，Python3 将文本和二进制进行分离。

> Unicode 为了容纳各个国家文字，定义了一个字符与编码之间的关系，每个字符对应一个整数数值，称为 code point(码点)。

> UCS(Universal Coded Character Set)按编码的长度分为 UCS-2 和 UCS-4 两种，UCS-4 是 32 位，UCS-4 可以表示更多的字符，UCS 只规定了字符和码点的对应关系，不涉及存储和显示。

> UTF(Unicode Transformation Format)作用是将 code point 转换成计算机可以存储的字节格式。目前有 UTF-8、 UTF-16、 UTF-32 多种方案。常用的有 UTF-8，由于是可变长，所以存储效率高，UTF-16 使用两字节等长方案，可以更快的处理效率，所以常被使用为执行编码。

> UTF 还可以头部插入 BOM(byte order mark)来标志来标明使用的字节序，区分大小端(LE，BE)，所以编码又分为 UTF-16LE, UTF-32BE。

{% highlight python %}

>>> s = "ɖ 中文"
>>> s.encode("utf-8") # 使用 UTF-8 编码转换成字节
b'\xc9\x96\xe4\xb8\xad\xe6\x96\x87'
>>> s.encode("utf-16") # 使用 UTF-16 编码转换成字节
b'\xff\xfeV\x02-N\x87e' # 头部`\xff`为 BOM 信息
>>> hex(ord(s[1]))
'0x4e2d'
>>> chr(0x4e2d)
'中'

{% endhighlight python %}

### bytes与bytearray

bytes 是不可变的字节序列，bytes 可以和 str 进行相互转换。
{% highlight python %}

>>> b = bytes("中文", "utf-8")
>>> b
b'\xc9\x96\xe4\xb8\xad\xe6\x96\x87'
>>> b1 = bytes(s, "utf-8")
>>> b1
中文
>>> bytes(s, "utf-16")
b'\xff\xfeV\x02-N\x87e'
>>> s.encode("gb2312")
b'\xd6\xd0\xce\xc4'

{% endhighlight python %}

与 bytes 不同，bytearray 可以按需扩张。

{% highlight python %}
>>> b = bytearray(b"abc")
>>> b.append(0x4e)
>>> b
bytearray(b'abcN')

{% endhighlight python %}

### bool

布尔是整数的子类型，也就是说 True 和 False 分别对应 1 和 0，bool 类型可以和整数类型进行运算。
{% highlight python %}

>>> True + 1
2
>>> False + 1
1
>>> True + False
1
>>> list(range(10))[False]
0
>>> list(range(10))[True]
1

{% endhighlight python %}

### list
从操作上来看，list 像是数组和链表的结合体，list 可以通过索引访问，也可以通过切片访问，list 可以动态扩展。

*如果有大量的写操作，建议使用`collections.deque queue` 等类型。*

列表内部结构由两部分组成，保存元素数量和内存分配计数的头部，以及存储元素指针的独立数组。所有元素项使用该数组保存指针引用，并不嵌入实际内容。

### dict

### tuple

### set/frozenset
